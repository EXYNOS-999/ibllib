<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>filter_units &mdash; Brainbox 0.1.0 documentation</title>
    
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-extend.css">
    <link rel="stylesheet" href="../_static/scipy.css" type="text/css" >
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" >
    <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" >
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/copybutton.js"></script>
    <link rel="index" title="Index" href="../genindex.html" >
    <link rel="search" title="Search" href="../search.html" >
    <link rel="top" title="Brainbox 0.1.0 documentation" href="../index.html" >
    <link rel="up" title="brainbox.processing: Functions for transforming data" href="../modules/processing.html" >
    <link rel="next" title="get_units_bunch" href="brainbox.processing.processing.get_units_bunch.html" >
    <link rel="prev" title="bincount2D" href="brainbox.processing.processing.bincount2D.html" > 
  </head>
  <body>

  <div class="container">
    <div class="header">
    </div>
  </div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
        <li class="active"><a href="["></a></li>
        <li class="active"><a href="]"></a></li>
	
        <li class="active"><a href="../index.html">Brainbox 0.1.0 documentation</a></li>
	
          <li class="active"><a href="../modules/processing.html" accesskey="U"><cite>brainbox.processing</cite>: Functions for transforming data</a></li> 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="../genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="../py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
      <li class="active">
        <a href="brainbox.processing.processing.get_units_bunch.html" title="get_units_bunch"
           accesskey="N">next</a>
      </li>
      <li class="active">
        <a href="brainbox.processing.processing.bincount2D.html" title="bincount2D"
           accesskey="P">previous</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="brainbox.processing.processing.bincount2D.html"
                        title="previous chapter">bincount2D</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="brainbox.processing.processing.get_units_bunch.html"
                        title="next chapter">get_units_bunch</a></p>
  <h3>This Page</h3>
  <div>
    <a href="../_sources/api/brainbox.processing.processing.filter_units.rst.txt"
       rel="nofollow">Show Source</a>
  </div>
<div class="this-page-menu">
  <a href="/scipy/docs/scipy-docs/api/brainbox.processing.processing.filter_units.rst.rst">Edit page</a>
</div>

        </div>
      </div>
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <div class="section" id="filter-units">
<h1>filter_units<a class="headerlink" href="#filter-units" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="brainbox.processing.processing.filter_units">
<code class="sig-name descname">filter_units</code><span class="sig-paren">(</span><em class="sig-param">units_b</em>, <em class="sig-param">t</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#brainbox.processing.processing.filter_units" title="Permalink to this definition">¶</a></dt>
<dd><p>Filters units according to some parameters. <a href="#id1"><span class="problematic" id="id2">**</span></a>kwargs are the keyword parameters used to filter
the units.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>units_b</strong> (<em>bunch</em>) – A bunch with keys of labels of spike information (e.g. cluster IDs, times, features, etc.)
whose values are arrays that hold values for each unit. The arrays for each key are ordered
by unit ID.</p></li>
<li><p><strong>t</strong> (<em>float</em>) – Duration of time over which to calculate the firing rate and false positive rate.</p></li>
<li><p><strong>Parameters</strong> (<em>Keyword</em>) – </p></li>
<li><p><strong>------------------</strong> – </p></li>
<li><p><strong>min_amp</strong> (<em>float</em>) – The minimum mean amplitude (in V) of the spikes in the unit. Default value is 50e-6.</p></li>
<li><p><strong>min_fr</strong> (<em>float</em>) – The minimum firing rate (in Hz) of the unit. Default value is 0.5.</p></li>
<li><p><strong>max_fpr</strong> (<em>float</em>) – The maximum false positive rate of the unit (using the fp formula in Hill et al. (2011)
J Neurosci 31: 8699-8705). Default value is 0.2.</p></li>
<li><p><strong>rp</strong> (<em>float</em>) – The refractory period (in s) of the unit. Used to calculate <cite>max_fp</cite>. Default value is
0.002.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>filt_units</strong> – The ids of the filtered units.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="brainbox.processing.processing.get_units_bunch.html#brainbox.processing.processing.get_units_bunch" title="brainbox.processing.processing.get_units_bunch"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_units_bunch()</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<ol class="arabic">
<li><dl>
<dt>Filter units according to the default parameters.</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">brainbox</span> <span class="k">as</span> <span class="nn">bb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">alf.io</span> <span class="k">as</span> <span class="nn">aio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibllib.ephys.spikes</span> <span class="k">as</span> <span class="nn">e_spks</span>
<span class="go">(*Note, if there is no &#39;alf&#39; directory, make &#39;alf&#39; directory from &#39;ks2&#39; output directory):</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_spks</span><span class="o">.</span><span class="n">ks2_to_alf</span><span class="p">(</span><span class="n">path_to_ks_out</span><span class="p">,</span> <span class="n">path_to_alf_out</span><span class="p">)</span>
<span class="go"># Get a spikes bunch, units bunch, and filter the units.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spks_b</span> <span class="o">=</span> <span class="n">aio</span><span class="o">.</span><span class="n">load_object</span><span class="p">(</span><span class="n">path_to_alf_out</span><span class="p">,</span> <span class="s1">&#39;spikes&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">units_b</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">processing</span><span class="o">.</span><span class="n">get_units_bunch</span><span class="p">(</span><span class="n">spks_b</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;times&#39;</span><span class="p">,</span> <span class="s1">&#39;amps&#39;</span><span class="p">,</span> <span class="s1">&#39;clusters&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">spks_b</span><span class="p">[</span><span class="s1">&#39;times&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">spks_b</span><span class="p">[</span><span class="s1">&#39;times&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_units</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">processing</span><span class="o">.</span><span class="n">filter_units</span><span class="p">(</span><span class="n">units_b</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ol>
<p>2) Filter units with no minimum amplitude, a minimum firing rate of 1 Hz, and a max false
positive rate of 0.2, given a refractory period of 2 ms.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_units</span>  <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">processing</span><span class="o">.</span><span class="n">filter_units</span><span class="p">(</span><span class="n">units_b</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">min_amp</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">min_fr</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt>TODO: <cite>units_b</cite> input arg could eventually be replaced by <cite>clstrs_b</cite> if the required metrics</dt><dd><p>are in <cite>clstrs_b[‘metrics’]</cite></p>
</dd>
</dl>
</dd></dl>

</div>


          </div>
        </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2020, Berk Gercek, Jai Bhagat, Matthew Whiteway, Olivier Winter,International Brain Laboratory.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 2.3.1.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>